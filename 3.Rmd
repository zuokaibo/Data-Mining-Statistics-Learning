---
title: "HW3"
author: "Bo"
date: "2026-02-16"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
# check correlation and plot them using corrplot package
library(corrplot)

# split dataset using caTools pacakge, 
library(caTools)

# apply LDA  and QDA 
library(MASS)

# creating confusion matrix
library(caret)

# check equal covirance between classes 
library(heplots)

#check if LDA or QDA fit, using partimat to see partition plots
library(klaR)

# Naive Bayes
library(e1071)
```



```{r cars}
data = read.csv("Auto.csv")
head(data)
#str(data)
```


```{r pressure, echo=FALSE}
median(data$mpg)
# make a indicator that value bigger than 22.75 and smaller than 22.75
# then use as.integer to transform False  True value obtained from flag to 0 and 1.
flag=I(data$mpg>=22.75)
mpg01 = as.numeric(flag)
```


```{r}
par(mfrow = c(1,2))
plot(data$displacement, data$mpg)
plot(data$horsepower, data$mpg)

par(mfrow = c(1,2))
plot(data$weight, data$mpg)
plot(data$acceleration, data$mpg)
```

```{r}
par(mfrow=c(2,2))
hist(data$displacement)
hist(data$horsepower)
hist(data$weight)
hist(data$acceleration)

par(mfrow=c(1,2))
hist(data$mpg)
hist(newdata$mpg01)
```


```{r}
corrplot(round(cor(data) ,2))
```


```{r}
pairs(data[, 3:6])
```



```{r}
newdata = cbind(mpg01, data[,2:8]) 

standardize=function(x){
  z=(x-min(x))/(max(x)-min(x))
  return(z)
}
```



```{r}
# normalize the numerical data, factorize categorical data. 

stand.newdata = as.data.frame(apply(newdata[, 3:6],2,standardize))
newdata = cbind(newdata[, 1:2], stand.newdata, newdata[, 7:8])
newdata$cylinders = as.factor(newdata$cylinders)
newdata$year = as.factor(newdata$year)
newdata$origin = as.factor(newdata$origin)
str(newdata)
head(newdata)
```


```{r}
split = sample.split(newdata$mpg01, SplitRatio = 0.8)
traindata = subset(newdata, split == TRUE)
testdata = subset(newdata, split == FALSE)
#head(traindata)
```



```{r}
lda.full.model = lda(mpg01~., traindata)
lda.full.model
plot(lda.full.model, dimen=1, type="b")
```

```{r}
lda.full.pred = predict(lda.full.model, newdata=testdata)
#lda.full.pred$class
#testdata$mpg01
lda.matrix = confusionMatrix(data=as.factor(lda.full.pred$class), reference = as.factor(testdata$mpg01))
lda.matrix
```

```{r}
# QDA
qda.model = qda(mpg01~., data=newdata)
qda.model
```

```{r}
qda.pred = predict(qda.model, newdata=testdata)
#qda.pred
qda.matrix = confusionMatrix(data=as.factor(qda.pred$class), reference = as.factor(testdata$mpg01))
qda.matrix
```


```{r}
colnames(newdata)
```



```{r}
lda.partition = partimat(as.factor(mpg01)~cylinders+displacement+horsepower+weight+acceleration, testdata, method = "lda")

qda.partition = partimat(as.factor(mpg01)~cylinders+displacement+horsepower+weight+acceleration, testdata, method = "qda")
```


```{r}

```

```{r}


```














