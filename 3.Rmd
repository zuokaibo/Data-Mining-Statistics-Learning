---
title: "HW3"
author: "Bo"
date: "2026-02-16"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r cars}
data = read.csv("Auto.csv")
head(data)
#str(data)
```


```{r pressure, echo=FALSE}
median(data$mpg)
# make a indicator that value bigger than 22.75 and smaller than 22.75
# then use as.integer to transform False  True value obtained from flag to 0 and 1.
flag=I(data$mpg>=22.75)
mpg01 = as.numeric(flag)
#mpg01
```


```{r}
newdata = cbind(mpg01, data[,2:8]) 
ncol(newdata)
head(newdata)
```


```{r}
par(mfrow = c(1,2))
plot(data$displacement, data$mpg)
plot(data$horsepower, data$mpg)

par(mfrow = c(1,2))
plot(data$weight, data$mpg)
plot(data$acceleration, data$mpg)
```

```{r}
par(mfrow=c(2,2))
hist(data$displacement)
hist(data$horsepower)
hist(data$weight)
hist(data$acceleration)

par(mfrow=c(1,2))
hist(data$mpg)
hist(newdata$mpg01)
```


```{r}
library(corrplot)
```

```{r}
corrplot(round(cor(data) ,2))
```


```{r}
pairs(data[, 3:6])
```

```{r}
# split dataset using caTools pacakge, 
library(caTools)
```


```{r}
split = sample.split(newdata$mpg01, SplitRatio = 0.8)
traindata = subset(newdata, split == TRUE)
testdata = subset(newdata, split == FALSE)

#nrow(traindata)
#nrow(testdata)

#head(traindata)
#head(testdata)
```


```{r}
# LDA 
library(MASS)
library(caret)

```


```{r}
# check equal covirance between classes to check if LDA fits 
library(heplots)
```


```{r}
lda.full.model = lda(mpg01~., traindata)
lda.full.model
plot(lda.full.model, dimen=1, type="b")
```

```{r}
lda.full.pred = predict(lda.full.model, newdata=testdata)
#lda.full.pred$class
#testdata$mpg01
lda.matrix = confusionMatrix(data=as.factor(lda.full.pred$class), reference = as.factor(testdata$mpg01))
lda.matrix
```

```{r}
# QDA
qda.model = qda(mpg01~., data=newdata)
qda.model
```

```{r}
qda.pred = predict(qda.model, newdata=testdata)
#qda.pred
qda.matrix = confusionMatrix(data=as.factor(qda.pred$class), reference = as.factor(testdata$mpg01))
qda.matrix
```


```{r}
#check partition plot using LDA and QDA.
library(klaR)
```


```{r}
colnames(newdata)
```



```{r}
lda.partition = partimat(as.factor(mpg01)~cylinders+displacement+horsepower+weight+acceleration, testdata, method = "lda")

qda.partition = partimat(as.factor(mpg01)~cylinders+displacement+horsepower+weight+acceleration, testdata, method = "qda")
```


```{r}
# Bayes Naive

```















