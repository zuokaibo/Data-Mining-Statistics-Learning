---
title: "HW3"
author: "Bo"
date: "2026-02-16"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
# check correlation and plot them using corrplot package
library(corrplot)

# split dataset using caTools pacakge, 
library(caTools)

# apply LDA  and QDA 
library(MASS)

# creating confusion matrix
library(rlang)
library(ggplot2)
library(caret)

# check equal covirance between classes 
library(heplots)

#check if LDA or QDA fit, using partimat to see partition plots
library(klaR)

# Naive Bayes
library(e1071)

#logistic model
library(dplyr)

# apply ROC curve
library(pROC) 

```


```{r cars}
data = read.csv("Auto.csv")
head(data)
#str(data)
```


```{r pressure, echo=FALSE}
median(data$mpg)
# make a indicator that value bigger than 22.75 and smaller than 22.75
# then use as.integer to transform False  True value obtained from flag to 0 and 1.
flag=I(data$mpg>=22.75)
mpg01 = as.numeric(flag)
```


```{r}
par(mfrow = c(1,2))
plot(data$displacement, data$mpg)
plot(data$horsepower, data$mpg)

par(mfrow = c(1,2))
plot(data$weight, data$mpg)
plot(data$acceleration, data$mpg)
```

```{r}
par(mfrow=c(2,2))
hist(data$displacement)
hist(data$horsepower)
hist(data$weight)
hist(data$acceleration)

par(mfrow=c(1,2))
hist(data$mpg)
hist(mpg01)
```


```{r}
corrplot(round(cor(data) ,2))
```


```{r}
pairs(data[, 3:6])
```



```{r}
newdata = cbind(mpg01, data[,2:8]) 

standardize=function(x){
  z=(x-min(x))/(max(x)-min(x))
  return(z)
}
```



```{r}
# normalize the numerical data, factorize categorical data. 

stand.newdata = as.data.frame(apply(newdata[, 3:6],2,standardize))
newdata = cbind(newdata[, 1:2], stand.newdata, newdata[, 7:8])
newdata$mpg01 = as.factor(newdata$mpg01)
newdata$cylinders = as.factor(newdata$cylinders)
newdata$year = as.factor(newdata$year)
newdata$origin = as.factor(newdata$origin)
#str(newdata)
head(newdata)
```


```{r}
split = sample.split(newdata$mpg01, SplitRatio = 0.8)
traindata = subset(newdata, split == TRUE)
testdata = subset(newdata, split == FALSE)
#head(traindata)
```



```{r}
lda.full.model = lda(mpg01~., traindata)
lda.full.model
plot(lda.full.model, dimen=1, type="b")
```

```{r}
lda.full.pred = predict(lda.full.model, newdata=testdata)
#lda.full.pred$class
#testdata$mpg01
lda.matrix = confusionMatrix(data=as.factor(lda.full.pred$class), reference = as.factor(testdata$mpg01))
lda.matrix
```


```{r}
lda.roc = roc(testdata$mpg01, as.numeric(lda.full.pred$class))
plot(lda.roc, col="darkblue", main="Roc curve of LDA classifier")
auc(lda.roc)
```



```{r}
# QDA
qda.model = qda(mpg01~., data=newdata)
qda.model
```

```{r}
qda.pred = predict(qda.model, newdata=testdata)
#as.numeric(qda.pred$class)
qda.matrix = confusionMatrix(data=as.factor(qda.pred$class), reference = as.factor(testdata$mpg01))
qda.matrix
```


```{r}
qda.roc = roc(testdata$mpg01, as.numeric(qda.pred$class))
plot(qda.roc, col="black", main="Roc curve of QDA classifier")
auc(qda.roc)

```



```{r}
# reset plot margin from bottom, left, top, right order.
par(mar = c(2, 2, 1, 0.5))

lda.partition = partimat(mpg01~as.numeric(cylinders)+displacement+horsepower+weight+acceleration, testdata, method = "lda")

qda.partition = partimat(mpg01~as.numeric(cylinders)+displacement+horsepower+weight+acceleration, testdata, method = "qda")
```


```{r}
# using e1071 package to perform naive bayes classifier.
naive.model = naiveBayes(mpg01~., traindata)
naive.model
```

```{r}
naive.model.pred = predict(naive.model, newdata = testdata)
#as.numeric(naive.model.pred)

naive.matrix = confusionMatrix(testdata$mpg01, as.factor(naive.model.pred))
naive.matrix
```


```{r}
naive.roc <- roc(testdata$mpg01, as.numeric(naive.model.pred))
plot(naive.roc, col = "red", main="Roc curve of Naive Bayes classifier")  
auc(naive.roc)
```







```{r}
#Logistic Regression using dplyr package.
logistic.model = glm (mpg01~., data=traindata, family = "binomial")
summary(logistic.model)

```


```{r}
logistic.pred = predict(logistic.model, newdata=testdata, type = "response")
#logistic.pred

logistic.classification = ifelse(logistic.pred >= 0.5, 1, 0)
head(logistic.classification)

#logistic.matrix = confusionMatrix(testdata$mpg01, as.factor(logistic.pred$class))
#logistic.matrix
```


```{r}
logistic.matrix = confusionMatrix(testdata$mpg01, as.factor(logistic.classification))
logistic.matrix
```


```{r}
logistic.roc <- roc(testdata$mpg01, logistic.pred)  
plot(logistic.roc, col = "brown", main="Roc curve of Logistic Regression classifier")  
auc(logistic.roc)
```


```{r}
#knn



```




